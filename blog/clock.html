<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue 仿华为 EMUI 系统桌面时钟 | 梦了然然</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="/shortcut icon" href="/yi-blog/favicon.png">
    <meta name="description" content="梦了然然">
    
    <link rel="preload" href="/yi-blog/assets/css/0.styles.25f00920.css" as="style"><link rel="preload" href="/yi-blog/assets/js/app.6f6874a9.js" as="script"><link rel="preload" href="/yi-blog/assets/js/4.717f7ba6.js" as="script"><link rel="preload" href="/yi-blog/assets/js/2.6b638d4f.js" as="script"><link rel="preload" href="/yi-blog/assets/js/32.7790f7a6.js" as="script"><link rel="preload" href="/yi-blog/assets/js/5.4eb2369d.js" as="script"><link rel="preload" href="/yi-blog/assets/js/8.ad207cb4.js" as="script"><link rel="prefetch" href="/yi-blog/assets/js/10.e0ccc183.js"><link rel="prefetch" href="/yi-blog/assets/js/11.436d186b.js"><link rel="prefetch" href="/yi-blog/assets/js/12.79a81333.js"><link rel="prefetch" href="/yi-blog/assets/js/13.c7cfd8f8.js"><link rel="prefetch" href="/yi-blog/assets/js/14.5b360613.js"><link rel="prefetch" href="/yi-blog/assets/js/15.d53edd17.js"><link rel="prefetch" href="/yi-blog/assets/js/16.5af8f676.js"><link rel="prefetch" href="/yi-blog/assets/js/17.afa5609b.js"><link rel="prefetch" href="/yi-blog/assets/js/18.12fc860a.js"><link rel="prefetch" href="/yi-blog/assets/js/19.9ef67c78.js"><link rel="prefetch" href="/yi-blog/assets/js/20.54560291.js"><link rel="prefetch" href="/yi-blog/assets/js/21.436aba33.js"><link rel="prefetch" href="/yi-blog/assets/js/22.61a8d35d.js"><link rel="prefetch" href="/yi-blog/assets/js/23.674e979e.js"><link rel="prefetch" href="/yi-blog/assets/js/24.1803b8aa.js"><link rel="prefetch" href="/yi-blog/assets/js/25.38ae7861.js"><link rel="prefetch" href="/yi-blog/assets/js/26.499c2604.js"><link rel="prefetch" href="/yi-blog/assets/js/27.467810ae.js"><link rel="prefetch" href="/yi-blog/assets/js/28.f0843f77.js"><link rel="prefetch" href="/yi-blog/assets/js/29.0a19bbce.js"><link rel="prefetch" href="/yi-blog/assets/js/3.ea3df8b1.js"><link rel="prefetch" href="/yi-blog/assets/js/30.d61e25a8.js"><link rel="prefetch" href="/yi-blog/assets/js/31.d007c8ac.js"><link rel="prefetch" href="/yi-blog/assets/js/33.b8985263.js"><link rel="prefetch" href="/yi-blog/assets/js/34.a62ff764.js"><link rel="prefetch" href="/yi-blog/assets/js/35.ed2f2d72.js"><link rel="prefetch" href="/yi-blog/assets/js/36.f533ec24.js"><link rel="prefetch" href="/yi-blog/assets/js/37.f1433bd8.js"><link rel="prefetch" href="/yi-blog/assets/js/38.1b0b05ac.js"><link rel="prefetch" href="/yi-blog/assets/js/39.cb48d49a.js"><link rel="prefetch" href="/yi-blog/assets/js/40.5c6fd79f.js"><link rel="prefetch" href="/yi-blog/assets/js/41.ace9b6b4.js"><link rel="prefetch" href="/yi-blog/assets/js/42.f2fcffaa.js"><link rel="prefetch" href="/yi-blog/assets/js/43.b92a27c6.js"><link rel="prefetch" href="/yi-blog/assets/js/44.1754abd8.js"><link rel="prefetch" href="/yi-blog/assets/js/45.2c4b37fa.js"><link rel="prefetch" href="/yi-blog/assets/js/46.9f54625d.js"><link rel="prefetch" href="/yi-blog/assets/js/47.1bfe7f4f.js"><link rel="prefetch" href="/yi-blog/assets/js/48.abd249aa.js"><link rel="prefetch" href="/yi-blog/assets/js/49.1561692b.js"><link rel="prefetch" href="/yi-blog/assets/js/50.6b971971.js"><link rel="prefetch" href="/yi-blog/assets/js/51.851a3236.js"><link rel="prefetch" href="/yi-blog/assets/js/52.e97fa695.js"><link rel="prefetch" href="/yi-blog/assets/js/53.835d1291.js"><link rel="prefetch" href="/yi-blog/assets/js/54.b7124ada.js"><link rel="prefetch" href="/yi-blog/assets/js/55.84fd79e5.js"><link rel="prefetch" href="/yi-blog/assets/js/56.d5ac5493.js"><link rel="prefetch" href="/yi-blog/assets/js/6.c90471de.js"><link rel="prefetch" href="/yi-blog/assets/js/7.bc4fd879.js"><link rel="prefetch" href="/yi-blog/assets/js/9.d807969d.js">
    <link rel="stylesheet" href="/yi-blog/assets/css/0.styles.25f00920.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/yi-blog/" class="home-link router-link-active"><!----> <span class="site-name">梦了然然</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/yi-blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/yi-blog/blog/" class="nav-link router-link-active">博文</a></div><div class="nav-item"><a href="/yi-blog/star.html" class="nav-link">收藏</a></div><div class="nav-item"><a href="/yi-blog/timeline.html" class="nav-link">心路</a></div><div class="nav-item"><a href="https://github.com/joyran" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/yi-blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/yi-blog/blog/" class="nav-link router-link-active">博文</a></div><div class="nav-item"><a href="/yi-blog/star.html" class="nav-link">收藏</a></div><div class="nav-item"><a href="/yi-blog/timeline.html" class="nav-link">心路</a></div><div class="nav-item"><a href="https://github.com/joyran" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <!----> </aside> <!----> <main class="page" data-v-a41eed80> <section class="page-header" data-v-a41eed80><div class="page-title" data-v-a41eed80>Vue 仿华为 EMUI 系统桌面时钟</div></section> <div class="theme-default-content content__default" data-v-a41eed80><p>拖了好久，我的个人网站算是正式对外营业了🎉🎉🎉。用了当下最火的 VuePress 框架，
当然首页和文章页我都重写了，使其更像个人博客，而非技术文档。</p> <p>言归正传，最近闲来无聊想写一个时钟练练手，自己用的是华为 Magic2，看了眼自带的时钟图标，
还挺顺眼，那就拿你下手了。下面是两个已经撸好的成品，左边是用 CSS 写的，右边是用 Canvas 画的，
由于时间关系 Canvas 没有画数字刻度。(就是懒而已😂)</p> <div class="clock-wrapper" style="width:200px;height:200px;font-size:20px;" data-v-4a738817><div class="clock" data-v-4a738817><div class="marks" data-v-4a738817><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div></div> <ul class="hour-number-marks" data-v-4a738817><li class="hour-number-mark" data-v-4a738817>
        1
      </li><li class="hour-number-mark" data-v-4a738817>
        2
      </li><li class="hour-number-mark" data-v-4a738817>
        3
      </li><li class="hour-number-mark" data-v-4a738817>
        4
      </li><li class="hour-number-mark" data-v-4a738817>
        5
      </li><li class="hour-number-mark" data-v-4a738817>
        6
      </li><li class="hour-number-mark" data-v-4a738817>
        7
      </li><li class="hour-number-mark" data-v-4a738817>
        8
      </li><li class="hour-number-mark" data-v-4a738817>
        9
      </li><li class="hour-number-mark" data-v-4a738817>
        10
      </li><li class="hour-number-mark" data-v-4a738817>
        11
      </li><li class="hour-number-mark" data-v-4a738817>
        12
      </li></ul> <div class="hour-hand" style="transition:all 0.3s;transform:translateX(-50%) rotate(90deg);" data-v-4a738817></div> <div class="minute-hand" style="transition:all 0.3s;transform:translateX(-50%) rotate(150deg);" data-v-4a738817></div> <div class="second-hand" style="transition:all 0.3s;transform:translateX(-50%) rotate(354deg);" data-v-4a738817></div> <div class="inner-circle" data-v-4a738817></div></div></div> <div class="clock-canvas-wrapper" data-v-0fd6a2a4><canvas width="160" height="160" class="clock" data-v-0fd6a2a4></canvas></div> <p><a href="https://github.com/joyran/yi-blog/blob/master/docs/.vuepress/components/ClockCss.vue" target="_blank" rel="noopener noreferrer">CSS 时钟源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://github.com/joyran/yi-blog/blob/master/docs/.vuepress/components/ClockCanvas.vue" target="_blank" rel="noopener noreferrer">Canvas 时钟源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>接下来挑重点讲解下实现过程中一些我认为的难点😂，大神请略过。</p> <h3 id="刻度"><a href="#刻度" class="header-anchor">#</a> 刻度</h3> <p>刻度是啥，刻度是均匀分布在时钟内环的60个点或者线，用于指示具体时间。我想到的实现方式有四种。</p> <ul><li>背景图片，最 low 也是最简单的方法。</li> <li>CSS</li> <li>Canvas</li> <li>SVG</li></ul> <p>CSS 画刻度很简单，首先用 for 循环出来30个刻度，索引为5的倍数是时针的刻度，
要和秒针样式区分，故添加了一个<code>mark-hour</code>类。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>marks<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
    <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in 30<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[
      <span class="token punctuation">'</span>mark<span class="token punctuation">'</span>,
      index % 5 === 0 ? <span class="token punctuation">'</span>mark-hour<span class="token punctuation">'</span> : <span class="token punctuation">'</span><span class="token punctuation">'</span>
    ]<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>刚刚我还说一共有60个刻度，怎么这里只有30个呢，原来用一个 div 表示两个刻度了，
在 div 上用伪类 before 表示12点的刻度，伪类 after 表示6点的刻度。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.mark</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">transform-origin</span><span class="token punctuation">:</span> center center<span class="token selector">;

  &amp;::before</span> <span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 0.1em<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #fafafa<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0.1em<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">&amp;::after</span> <span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 0.1em<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #fafafa<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> 0.1em<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>第一个刻度好了后，第二个刻度只要以中心点旋转6°就好了，依次类推，这种有规律的变化当然得借助预处理器 less/scss 的循环了。
一开始用的是 less，因为 node-sass 真的太难安装了。但是这个 less 的 for 循环太反人类了，请自行感悟。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token function">mark-loop</span><span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@n</span><span class="token punctuation">,</span> @<span class="token property">i</span><span class="token punctuation">:</span>1<span class="token punctuation">)</span> when <span class="token punctuation">(</span>@i &lt;= @n<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.mark:nth-child(@</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token selector">)</span> <span class="token punctuation">{</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>6deg * <span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@i</span> - 1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
  <span class="token punctuation">}</span>
  <span class="token function">mark-loop</span><span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@n</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@i</span> + 1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span>
<span class="token punctuation">}</span>

<span class="token function">mark-loop</span><span class="token punctuation">(</span>30<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>由于实在忍受不了这种反人类的 for 循环写法，当机立断改用了 scss，来感受下 scss 的清爽。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@for</span> $i from 1 through 30</span> <span class="token punctuation">{</span>
  <span class="token selector">.mark:nth-child(#</span><span class="token punctuation">{</span>$i<span class="token punctuation">}</span><span class="token selector">)</span> <span class="token punctuation">{</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>6deg * <span class="token punctuation">(</span>$i - 1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="数字刻度"><a href="#数字刻度" class="header-anchor">#</a> 数字刻度</h3> <p>数字刻度指的是时针的刻度，从0到12，也是用 css 画出来，但不能用上面刻度的旋转，
因为一旦旋转数字就歪了，所以需要用三角函数结合绝对定位把12个数字定位到时钟圆盘上。
可惜 scss 没有三角函数，在网上 copy 了一份封装好的三角函数引用
<a href="https://github.com/joyran/yi-blog/blob/master/docs/.vuepress/sass-math.scss" target="_blank" rel="noopener noreferrer">sass-math<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，
然后用 margin 调整下间距就完工了。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@import</span> <span class="token string">'../../sass-math.scss'</span><span class="token punctuation">;</span></span>

<span class="token atrule"><span class="token rule">@for</span> $i from 1 through 12</span> <span class="token punctuation">{</span>
  <span class="token selector">.hour-number-mark:nth-child(#</span><span class="token punctuation">{</span>$i<span class="token punctuation">}</span><span class="token selector">)</span> <span class="token punctuation">{</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 4em + 4em * <span class="token function">cos</span><span class="token punctuation">(</span><span class="token punctuation">(</span>90 - $i * 30<span class="token punctuation">)</span> * <span class="token function">pi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> / 180<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> 4em + 4em * <span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span>90 - $i * 30<span class="token punctuation">)</span> * <span class="token function">pi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> / 180<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="时针"><a href="#时针" class="header-anchor">#</a> 时针</h3> <p>也是用绝对定位画一个时针，如下，分针和秒针同理。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.hour-hand</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 20%<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>    <span class="token comment">/* 水平居中 */</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">/* 水平居中 */</span>
  <span class="token comment">/* X轴以中心点旋转，宽度的二分之一，Y轴以底部旋转 */</span>
  <span class="token property">transform-origin</span><span class="token punctuation">:</span> 0.1em bottom<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 0.2em<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.2em<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> all 0.3s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>时针，分针和秒针画好后，接下来要让他们动起来，以秒针为例，每隔一秒都以顺时针旋转6°，
将旋转的角度设置为变量，然后调用 setInterval 每隔一秒重置一次角度变量达到秒针动起来的效果。</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>second-hand<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token punctuation">{</span> <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token string">'translateX(-50%) rotate('</span> + rotate.second + <span class="token string">'deg)'</span> <span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token comment">// 秒针的当前旋转角度</span>
      rotate<span class="token operator">:</span> <span class="token punctuation">{</span>
        second<span class="token operator">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">calcRotate</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>

    <span class="token comment">// 每隔一秒执行一次</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>interval <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">calcRotate</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 根据时间计算秒针的旋转角度</span>
    <span class="token function">calcRotate</span> <span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> second <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>rotate<span class="token punctuation">.</span>second <span class="token operator">=</span> second <span class="token operator">*</span> <span class="token number">6</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>这样看似很完美，但有一个问题，当秒针指到59秒时，角度为354°，下一秒秒针跑到0秒了，角度变成了0°
由于秒针的旋转加了 transition 过渡动效，导致从354°变成0°时不是从354°平滑过渡到0°，
而是以逆时针旋转到0°，显然这样是不行的。我想到了两种解决方案，一种是角度不重置，而是一直增加，
比如从59秒到0秒，角度是从354°到360°，一直累加。第二种是从354°到0°时去掉 transition 过渡动效。
这里偷个懒用了第二种方案。</p> <h3 id="待优化"><a href="#待优化" class="header-anchor">#</a> 待优化</h3> <p>组件加了一个参数 width，当传入的 width 为100时，就会发现秒针还有刻度都有点歪曲，因为秒针的宽度用了 em，
当 width 变小，秒针宽度也变小，当秒针宽度小到一定程度且旋转一个角度时浏览器渲染就有问题了，出现了锯齿。</p> <div class="clock-wrapper" style="width:100px;height:100px;font-size:10px;" data-v-4a738817><div class="clock" data-v-4a738817><div class="marks" data-v-4a738817><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark mark-hour" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div><div class="mark" data-v-4a738817></div></div> <ul class="hour-number-marks" data-v-4a738817><li class="hour-number-mark" data-v-4a738817>
        1
      </li><li class="hour-number-mark" data-v-4a738817>
        2
      </li><li class="hour-number-mark" data-v-4a738817>
        3
      </li><li class="hour-number-mark" data-v-4a738817>
        4
      </li><li class="hour-number-mark" data-v-4a738817>
        5
      </li><li class="hour-number-mark" data-v-4a738817>
        6
      </li><li class="hour-number-mark" data-v-4a738817>
        7
      </li><li class="hour-number-mark" data-v-4a738817>
        8
      </li><li class="hour-number-mark" data-v-4a738817>
        9
      </li><li class="hour-number-mark" data-v-4a738817>
        10
      </li><li class="hour-number-mark" data-v-4a738817>
        11
      </li><li class="hour-number-mark" data-v-4a738817>
        12
      </li></ul> <div class="hour-hand" style="transition:all 0.3s;transform:translateX(-50%) rotate(90deg);" data-v-4a738817></div> <div class="minute-hand" style="transition:all 0.3s;transform:translateX(-50%) rotate(150deg);" data-v-4a738817></div> <div class="second-hand" style="transition:all 0.3s;transform:translateX(-50%) rotate(354deg);" data-v-4a738817></div> <div class="inner-circle" data-v-4a738817></div></div></div></div> <footer class="page-edit" data-v-a41eed80><!----> <!----></footer> <!---->  <div class="theme-change" data-v-66feac70 data-v-a41eed80><img src="https://img-cdn.wezhuiyi.com/yi-blog/light-mode.svg" alt data-v-66feac70></div></main></div><div class="global-ui"></div></div>
    <script src="/yi-blog/assets/js/app.6f6874a9.js" defer></script><script src="/yi-blog/assets/js/4.717f7ba6.js" defer></script><script src="/yi-blog/assets/js/2.6b638d4f.js" defer></script><script src="/yi-blog/assets/js/32.7790f7a6.js" defer></script><script src="/yi-blog/assets/js/5.4eb2369d.js" defer></script><script src="/yi-blog/assets/js/8.ad207cb4.js" defer></script>
  </body>
</html>
